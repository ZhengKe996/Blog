---
title: '数据链路层'
date: 2023-11-02
type: NetWork
---

## 数据链路层概述

- **链路（Link）**是指从一个节点到相邻节点的一段物理线路（有线或无线），而**中间没有任何其他的交换节点**。
- 数据链路（Data Link）是基于链路的。当在一条链路上传送数据时，除需要链路本身，还需要一些必要的通信协议来控制这些数据的传输，**把实现这些协议的硬件和软件加到链路上**，就构成了数据链路。
- 计算机中的**网络适配器**（俗称网卡）和其相应的软件驱动程序就实现了这些协议。一般的**网络适配器都包含了物理层和数据链路层这两层的功能**。
- 帧（Frame）是**数据链路层**对等实体之间在水平方向进行逻辑通信的协议数据单元 **PDU**。

## 数据链路层的三个重要问题

### 封装成帧

- 封装成帧是指数据链路层给上层交付下来的协议数据单元 PDU 添加一个首部和一个尾部，使之成为帧。

  - 帧的首部和尾部中包含有一些**重要的控制信息**。
  - 帧首部和尾部的作用之一就是**帧定界**。
  - `[注]` 并不是每一种数据链路层协议的帧都包含有帧定界标志。
  - 帧间间隔（发送 96 比特所耗费的时间）

- 为了提高数据链路层传输帧的效率，应当使**帧的数据载荷的长度尽可能地大于首部和尾部的长度**。
- 考虑到对缓存空间的需求以及差错控制等诸多因素，每一种数据链路层协议都规定了帧的数据载荷的长度上限，即**最大传送单元**（Maximum Transfer Unit，MTU）。例如，以太网的 MTU 为 1500 个字节。

![封装成帧](/public/images/network/03/1-1-1.png)
![封装成帧](/public/images/network/03/1-1-2.png)

![帧定界](/public/images/network/03/1-1-3.png)

### 透明传输

透明传输是指**数据链路层对上层交付下来的协议数据单元 PDU 没有任何限制**，就好像数据链路层不存在一样。

- 面向字节的物理链路使用**字节填充**的方法实现透明传输。
- 面向比特的物理链路使用**比特填充**的方法实现透明传输。(零比特填充：每 5 个 1 后插入一个 0)

![透明传输](/public/images/network/03/1-1-5.png)

### 差错检测

- 帧在传输的过程中可能出现误码。
- 接收方根据发送方添加在帧尾部中的检错码，可以检测出帧是否出现了误码。

#### 误码的相关概念

- 实际的通信链路都不是理想的，比特在传输过程中可能会产生差错（称为**比特差错**）
  - 比特 1 可能变成比特 0
  - 比特 0 可能变成比特 1
- 在一段时间内，传输错误的比特数量占所传输比特总数的比率称为**误码率**（Bit Error Rate，BER）。
- **提高链路的信噪比**，可以**降低误码率**。但在实际的通信链路上，不可能使误码率下降为零。
- 使用**差错检测技术**来检测数据在传输过程中是否产生了比特差错，是数据链路层所要解决的重要问题之一。

![差错检测](/public/images/network/03/1-1-6.png)

#### 奇偶校验

- 奇校验是在待发送的数据后面**添加 1 个校验位**，使得添加该校验位后的整个数据中**比特 1 的个数为奇数**。
- 偶校验是在待发送的数据后面**添加 1 个校验位**，使得添加该校验位后的整个数据中**比特 1 的个数为偶数**。
- 在所传输的数据中，如果有**奇数个位发生误码**，则所包含比特 1 的数量的奇偶性会发生改变，**可以检测出误码**。
- 在所传输的数据中，如果有**偶数个位发生误码**，则所包含比特 1 的数量的奇偶性不会发生改变，**无法检测出误码（漏检）**。
- 在实际使用时，奇偶校验又可分为垂直奇偶校验、水平奇偶校验以及水平垂直奇偶校验。

#### 循环冗余校验（CRC）

- 数据链路层广泛使用漏检率极低的循环冗余校验（Cyclic Redundancy Check，CRC）检错技术。

  - 收发双方约定好一个生成多项式 G(X)。
  - 发送方基于待发送的数据和**生成多项式 G(X)**，计算出差错检测码（冗余码），将冗余码添加到待发送数据的后面一起传输。
  - 接收方收到数据和冗余码后，通过生成多项式 G(X)来计算收到的数据和冗余码是否产生了误码。

![CRC](/public/images/network/03/1-1-7.png)
![CRC](/public/images/network/03/1-1-8.png)

### 可靠传输

- 不可靠传输服务：收到有误码的帧，直接丢弃，其他什么也不做；未收到发送方发送的帧，也不进行任何处理。
- 可靠传输服务：实现发送方发送什么，接收方最终都能正确收到。
