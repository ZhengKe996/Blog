---
title: '拓扑排序'
date: 2023-10-13
type: Greed
---

`给定一个有向图，图节点的拓扑排序定义如下:`

`对于图中的每一条有向边 A -> B , 在拓扑排序中 A 一定在 B 之前.拓扑排序中的第一个节点可以是图中的任何一个没有其他节点指向它的节点.针对给定的有向图找到任意一种拓扑排序的顺序`

![拓扑排序](/public/images/ds/graph/0000.jpg)

```java

class DirectedGraphNode {
  int label;
  List<DirectedGraphNode> neighbors;

  DirectedGraphNode(int x) {
    label = x;
    neighbors = new ArrayList<DirectedGraphNode>();
  }
}

public ArrayList<DirectedGraphNode> topSort(ArrayList<DirectedGraphNode> graph) {
  HashMap<DirectedGraphNode, Integer> indegreeMap = new HashMap<>();
  for (DirectedGraphNode cur : graph)
    indegreeMap.put(cur, 0);

  for (DirectedGraphNode cur : graph) {
    for (DirectedGraphNode next : cur.neighbors)
      indegreeMap.put(next, indegreeMap.get(next) + 1);

  }
  Queue<DirectedGraphNode> zeroQueue = new LinkedList<>();
  for (DirectedGraphNode cur : indegreeMap.keySet()) {
    if (indegreeMap.get(cur) == 0)
      zeroQueue.add(cur);
  }

  ArrayList<DirectedGraphNode> ans = new ArrayList<>();
  while (!zeroQueue.isEmpty()) {
    DirectedGraphNode cur = zeroQueue.poll();
    ans.add(cur);
    for (DirectedGraphNode next : cur.neighbors) {
      indegreeMap.put(next, indegreeMap.get(next) - 1);
      if (indegreeMap.get(next) == 0)
        zeroQueue.offer(next);
    }
  }
  return ans;
}
```

## 思路二：

- 在图中从顶点 A 到顶点 B 有一条有向路径，则顶点 A 一定排在顶点 B 之前，满足这样的条件的顶点序列称为一个拓扑序。
- 拓扑排序有两个步骤：
  1. 从队列中获取一个入度为 0 的顶点
  2. 获取该顶点边，将边的另一端顶点入度减一，如果为 0，也入队列
- 重复步骤 1 和 2，直到队列为空，得到的出队顺序即为一个合理的拓扑序。

```cpp
vector<DirectedGraphNode *> topSort(vector<DirectedGraphNode *> graph) {
  vector<DirectedGraphNode *> ans;
  // in记录节点的入度
  unordered_map<DirectedGraphNode *, int> in;
  queue<DirectedGraphNode *> que;
  for (auto e : graph) {
    for (auto i : e->neighbors) {
      in[i]++;
    }
  }
  for (auto e : graph) {
    if (in[e] == 0) {
      que.push(e);
    }
  }
  while (!que.empty()) {
    DirectedGraphNode *now = que.front();
    que.pop();
    ans.push_back(now);
    for (auto e : now->neighbors) {
      if (--in[e] == 0) {
        que.push(e);
      }
    }
  }
  return ans;
}
```

<hr/>

| [C++ ](https://github.com/ZhengKe996/DS/blob/main/src/graph/Topology.cpp) | [Java ](https://github.com/ZhengKe996/DS/blob/main/src/graph/Topology.cpp) |
| :-----------------------------------------------------------------------: | :------------------------------------------------------------------------: |
