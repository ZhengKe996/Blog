---
title: 'æœ€é•¿å…¬å…±å­åºåˆ—'
date: 2023-10-30
type: DP
---

[é¢˜ç›®é“¾æ¥ ğŸ”—](https://leetcode.cn/problems/longest-common-subsequence)

> ç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸² text1 å’Œ text2ï¼Œè¿”å›è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²çš„æœ€é•¿ å…¬å…±å­åºåˆ— çš„é•¿åº¦ã€‚å¦‚æœä¸å­˜åœ¨ å…¬å…±å­åºåˆ— ï¼Œè¿”å› 0 ã€‚
>
> ä¸€ä¸ªå­—ç¬¦ä¸²çš„ å­åºåˆ— æ˜¯æŒ‡è¿™æ ·ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼šå®ƒæ˜¯ç”±åŸå­—ç¬¦ä¸²åœ¨ä¸æ”¹å˜å­—ç¬¦çš„ç›¸å¯¹é¡ºåºçš„æƒ…å†µä¸‹åˆ é™¤æŸäº›å­—ç¬¦ï¼ˆä¹Ÿå¯ä»¥ä¸åˆ é™¤ä»»ä½•å­—ç¬¦ï¼‰åç»„æˆçš„æ–°å­—ç¬¦ä¸²ã€‚
>
> ä¾‹å¦‚ï¼Œ"ace" æ˜¯ "abcde" çš„å­åºåˆ—ï¼Œä½† "aec" ä¸æ˜¯ "abcde" çš„å­åºåˆ—ã€‚
> ä¸¤ä¸ªå­—ç¬¦ä¸²çš„ å…¬å…±å­åºåˆ— æ˜¯è¿™ä¸¤ä¸ªå­—ç¬¦ä¸²æ‰€å…±åŒæ‹¥æœ‰çš„å­åºåˆ—ã€‚

## çº¯æš´åŠ›

ä» `str1[0...i]`å’Œ`str2[0...j]`ï¼Œè¿™ä¸ªèŒƒå›´ä¸Šæœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦æ˜¯å¤šå°‘ï¼Ÿ
å¯èƒ½æ€§åˆ†ç±»:

- æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œä¸€å®šä¸ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä¹Ÿä¸€å®šä¸ä»¥ `str2[j]`å­—ç¬¦ç»“å°¾
- æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œå¯èƒ½ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä½†æ˜¯ä¸€å®šä¸ä»¥ `str2[j]`å­—ç¬¦ç»“å°¾
- æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œä¸€å®šä¸ä»¥` `str1[i]`å­—ç¬¦ç»“å°¾ã€ä½†æ˜¯å¯èƒ½ä»¥ `str2[j]`å­—ç¬¦ç»“å°¾
- æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œå¿…é¡»ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä¹Ÿå¿…é¡»ä»¥ `str2[j]`å­—ç¬¦ç»“å°¾

è¿™å‡ ç§å¯èƒ½æ€§è°ƒç”¨åç»­çš„é€’å½’ã€‚

1.  æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œä¸€å®šä¸ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä¹Ÿä¸€å®šä¸ä»¥ `str2[j]`å­—ç¬¦ç»“å°¾

    - å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰`str1[i]`å’Œ str2[j]å°±æ ¹æœ¬ä¸é‡è¦äº†ï¼Œå› ä¸ºè¿™ä¸¤ä¸ªå­—ç¬¦ä¸€å®šæ²¡ç”¨;æ‰€ä»¥ç æ‰è¿™ä¸¤ä¸ªå­—ç¬¦ï¼Œæœ€é•¿å…¬å…±å­åºåˆ— = `str1[0...i-1]`ä¸ `str2[0...j-1]`çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦(åç»­é€’å½’)

2.  æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œå¯èƒ½ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä½†æ˜¯ä¸€å®šä¸ä»¥ `str2[j]`å­—ç¬¦ç»“å°¾

    - å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œå¯ä»¥ç¡®å®š`str2[j]`ä¸€å®šæ²¡æœ‰ç”¨ï¼Œè¦ç æ‰ï¼›ä½†æ˜¯ `str1[i]`å¯èƒ½æœ‰ç”¨ï¼Œæ‰€ä»¥è¦ä¿ç•™;æ‰€ä»¥ï¼Œæœ€é•¿å…¬å…±å­åºåˆ— = `str1[0...i]`ä¸ `str2[0...j-1]`çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦(åç»­é€’å½’)

3.  æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œä¸€å®šä¸ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä½†æ˜¯å¯èƒ½ä»¥ str2[j]å­—ç¬¦ç»“å°¾

    - æœ€é•¿å…¬å…±å­åºåˆ— = `str1[0...i-1]`ä¸ `str2[0...j]`çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦(åç»­é€’å½’)

4.  æœ€é•¿å…¬å…±å­åºåˆ—ï¼Œå¿…é¡»ä»¥ `str1[i]`å­—ç¬¦ç»“å°¾ã€ä¹Ÿå¿…é¡»ä»¥ str2[j]å­—ç¬¦ç»“å°¾
    - å¯èƒ½æ€§(4)å­˜åœ¨çš„æ¡ä»¶ï¼Œä¸€å®šæ˜¯åœ¨ `str1[i] == str2[j]`çš„æƒ…å†µä¸‹ï¼Œæ‰æˆç«‹çš„ æœ€é•¿å…¬å…±å­åºåˆ—æ€»é•¿åº¦ = `str1[0...i-1]ä¸ str2[0...j-1]`çš„æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦(åç»­é€’å½’) + 1(å…±åŒçš„ç»“å°¾)

```java
  public int longestCommonSubsequence1(String text1, String text2) {
    if (text1 == null || text2 == null || text1.length() == 0 || text2.length() == 0) return 0;
    char[] str1 = text1.toCharArray();
    char[] str2 = text2.toCharArray();
    return process1(str1, str2, str1.length - 1, str2.length - 1);
  }

  private static int process1(char[] str1, char[] str2, int i, int j) {
    if (i == 0 && j == 0) return str1[i] == str2[j] ? 1 : 0;
    else if (i == 0) {
      if (str1[i] == str2[j]) return 1;
      else return process1(str1, str2, i, j - 1);
    } else if (j == 0) {
      if (str1[i] == str2[j]) return 1;
      else return process1(str1, str2, i - 1, j);
    } else {
      int p1 = process1(str1, str2, i, j - 1);
      int p2 = process1(str1, str2, i - 1, j);
      int p3 = str1[i] == str2[j] ? 1 + process1(str1, str2, i - 1, j - 1) : 0;
      return Math.max(p1, Math.max(p2, p3));
    }
  }

```

## å‚»ç¼“å­˜ DP

```java
public int longestCommonSubsequence2(String text1, String text2) {
    if (text1 == null || text2 == null || text1.length() == 0 || text2.length() == 0) return 0;
    char[] str1 = text1.toCharArray();
    char[] str2 = text2.toCharArray();
    int N = str1.length;
    int M = str2.length;
    int[][] dp = new int[N][M];
    dp[0][0] = str1[0] == str2[0] ? 1 : 0;
    for (int j = 1; j < M; j++) dp[0][j] = str1[0] == str2[j] ? 1 : dp[0][j - 1];

    for (int i = 1; i < N; i++) dp[i][0] = str1[i] == str2[0] ? 1 : dp[i - 1][0];

    for (int i = 1; i < N; i++) {
      for (int j = 1; j < M; j++) {
        int p1 = dp[i][j - 1];
        int p2 = dp[i - 1][j];
        int p3 = str1[i] == str2[j] ? 1 + dp[i - 1][j - 1] : 0;
        dp[i][j] = Math.max(p1, Math.max(p2, p3));
      }
    }
    return dp[N - 1][M - 1];
  }
```

<hr/>

| [C++](https://github.com/ZhengKe996/DS/blob/main/src/dp/longest_common_subsequence.cpp) | [Java](https://github.com/ZhengKe996/DS/blob/main/src/dp/longest_common_subsequence.java) |
| :-------------------------------------------------------------------------------------: | :---------------------------------------------------------------------------------------: |
